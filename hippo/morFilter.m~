function Xf = morFilter(X,Fc,Fs,norm)
if ~exist('norm','var')
    norm = 1;
end
win = 5;
%Fc = 8.4 for hippocampus
%Fb = 1/500 for hippocampal LFP
%Fb = 1/50 for ripples
[psi,x] = cmorwavf(-1/win,1/win,Fs*2/win,1/5000,Fc);
Xf = zeros(size(X));
for i = 1:size(X,1)
    Xf(i,:) = fliplr(filter(conj(psi),1,fliplr(filter(psi,1,X(i,:)))));
    if (norm)
        Xf(i,:) = Xf(i,:)/std(Xf(i,:));
    end
end