function [actVal velVal] = velVsAct(act,vel,cull,pad)

if cull > 0
    for i = 1:size(act,1)
        temp = squeeze(act(i,:,:));
        t = mean(temp);
        aa = bsxfun(@minus,temp,t);%temp - u*s*v1';
        snr(i) = sum(abs(temp(:)).^2)./sum(abs(aa(:)).^2);
    end
    [~,inds] = sort(snr,'descend');
    act = act(inds(1:cull),:,:);
end
actm = abs(squeeze(mean(act,2)));
[~,maxInds] = max(actm,[],2);
for i = 1:size(act,1)
    %temp = squeeze(act(i,:,:));
    weighted = actm(i,:);
    weighted(1:maxInds(i)-pad) = 0;
    weighted(maxInds(i)+pad:end) = 0;
    actVal(i,:) = sum(bsxfun(@times,squeeze(abs(act(i,:,:))),weighted),2);
    actVal(i,:) = actVal(i,:)/sum(weighted);
    velVal(i,:) = sum(bsxfun(@times,vel,weighted),2);
    velVal(i,:) = velVal(i,:)/sum(weighted);
end
